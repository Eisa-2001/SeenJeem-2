<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ø³ÙŠÙ† Ø¬ÙŠÙ… â€” FINAL (No Repeat + Report + Import)</title>
  <style>
    :root{
      --bg:#070a12; --panel:#0f1630; --text:#e9eeff; --muted:#a9b4e6;
      --line:rgba(255,255,255,.12); --a1:#67e8f9; --a2:#a78bfa;
      --good:#22c55e; --bad:#ef4444; --warn:#f59e0b;
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:radial-gradient(900px 700px at 15% 10%, rgba(103,232,249,.12), transparent 60%),
                 radial-gradient(900px 700px at 85% 10%, rgba(167,139,250,.10), transparent 60%),
                 var(--bg);
      color:var(--text);
    }
    header{
      position:sticky;top:0;z-index:10;
      background:rgba(7,10,18,.72);backdrop-filter:blur(10px);
      border-bottom:1px solid var(--line);
    }
    .topbar{max-width:1100px;margin:0 auto;padding:10px 14px;display:flex;align-items:center;justify-content:space-between;gap:10px}
    .brand{display:flex;gap:10px;align-items:center}
    .logo{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,var(--a1),var(--a2))}
    h1{margin:0;font-size:15px}
    .sub{font-size:12px;color:var(--muted)}
    .btns{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
    button{
      cursor:pointer;border:1px solid var(--line);background:rgba(255,255,255,.04);
      color:var(--text);padding:10px 12px;border-radius:12px;font-weight:800
    }
    button:hover{background:rgba(255,255,255,.07)}
    button.primary{border:none;background:linear-gradient(135deg,var(--a1),var(--a2));color:#0b1020}
    button.danger{border-color:rgba(239,68,68,.45)}
    button.good{border-color:rgba(34,197,94,.45)}
    button.warn{border-color:rgba(245,158,11,.55)}
    .container{max-width:1100px;margin:0 auto;padding:16px}
    .page{display:none}
    .page.active{display:block}
    .card{background:rgba(255,255,255,.04);border:1px solid var(--line);border-radius:18px;padding:14px}
    .grid{display:grid;gap:12px}
    .grid.two{grid-template-columns:repeat(2,minmax(0,1fr))}
    @media(max-width:840px){.grid.two{grid-template-columns:1fr}}
    .titleRow{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:10px}
    .titleRow h2{margin:0;font-size:15px}
    .small{font-size:12px;color:var(--muted)}
    .field{display:flex;flex-direction:column;gap:6px;margin:10px 0}
    label{font-size:12px;color:var(--muted)}
    input[type="text"], input[type="number"]{
      padding:12px;border-radius:12px;border:1px solid var(--line);
      background:rgba(0,0,0,.25);color:var(--text)
    }
    .pill{padding:8px 10px;border-radius:999px;border:1px solid var(--line);background:rgba(255,255,255,.03);font-size:12px;color:var(--muted)}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .toggle{display:flex;gap:10px;align-items:center;margin-top:10px}
    input[type="checkbox"]{width:18px;height:18px}
    hr.sep{border:none;border-top:1px solid var(--line);margin:10px 0}

    .scorebar{display:flex;gap:10px;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-bottom:10px}
    .scorebox{display:flex;gap:10px;align-items:center;background:rgba(255,255,255,.04);border:1px solid var(--line);border-radius:14px;padding:10px 12px}
    .scorebox .name{font-weight:900}
    .scorebox .score{font-size:18px;font-weight:1000;background:linear-gradient(135deg,var(--a1),var(--a2));-webkit-background-clip:text;background-clip:text;color:transparent}
    .timer{font-variant-numeric:tabular-nums;font-weight:900}

    .board{display:grid;gap:10px;grid-template-columns:repeat(6,minmax(0,1fr))}
    @media(max-width:980px){.board{grid-template-columns:repeat(3,minmax(0,1fr))}}
    .col{border:1px solid var(--line);border-radius:16px;overflow:hidden;background:rgba(255,255,255,.03)}
    .colHead{padding:10px 8px;text-align:center;font-weight:1000;background:rgba(255,255,255,.05);border-bottom:1px solid var(--line);min-height:52px;display:flex;align-items:center;justify-content:center}
    .cell button{width:100%;border:0;border-bottom:1px solid var(--line);border-radius:0;background:transparent;padding:16px 8px;font-size:18px}
    .cell button.used{opacity:.35;text-decoration:line-through}
    .cell:last-child button{border-bottom:0}
    .p200{color:#bfefff}.p400{color:#d7c8ff}.p600{color:#ffd0b2}

    .catsGrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px}
    .catCard{padding:12px;cursor:pointer}
    .catCard.on{background:rgba(103,232,249,.10);border-color:rgba(103,232,249,.35)}
    .catCard.off{background:rgba(255,255,255,.03)}

    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.55);z-index:50;padding:16px}
    .modal.show{display:flex}
    .modalCard{width:min(920px,100%);background:rgba(12,16,30,.92);border:1px solid var(--line);border-radius:18px;overflow:hidden}
    .modalTop{display:flex;justify-content:space-between;align-items:center;gap:12px;padding:12px 14px;border-bottom:1px solid var(--line)}
    .modalTop .meta{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .modalBody{padding:14px}
    .qtext{font-size:18px;font-weight:900;line-height:1.6;margin:0 0 10px}
    .ans{display:none;margin-top:10px;padding:10px 12px;border-radius:14px;border:1px dashed rgba(255,255,255,.22);background:rgba(255,255,255,.04)}
    .ans.show{display:block}
    .ans .lbl{font-size:12px;color:var(--muted);margin-bottom:6px}
    .ans .aval{font-size:18px;font-weight:1000}
    .qimg{width:100%;max-height:360px;object-fit:contain;border-radius:16px;border:1px solid var(--line);background:rgba(0,0,0,.25)}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .actions button{flex:1;min-width:160px}
    .subpanel{display:none;margin-top:12px;padding:10px;border-radius:14px;border:1px solid var(--line);background:rgba(255,255,255,.03)}
    .subpanel.show{display:block}
    .teamBtns{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
    .teamBtns button{flex:1;min-width:160px}
    textarea{
      width:100%;min-height:140px;border-radius:14px;border:1px solid var(--line);
      background:rgba(0,0,0,.25);color:var(--text);padding:12px
    }
  </style>
</head>

<body>
<header>
  <div class="topbar">
    <div class="brand">
      <div class="logo"></div>
      <div>
        <h1>Ø³ÙŠÙ† Ø¬ÙŠÙ… â€” FINAL</h1>
        <div class="sub">Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© + Ø¨Ù„Ø§Øº Ø¹Ù† Ø³Ø¤Ø§Ù„ ØºÙ„Ø· + Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨Ù†Ùƒ Ø£Ø³Ø¦Ù„Ø©</div>
      </div>
    </div>
    <div class="btns">
      <button id="goSetup">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
      <button id="goSelect">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</button>
      <button id="goGame" class="primary">Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
      <button id="wipe" class="danger">ğŸ§¹ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div>
  </div>
</header>

<div class="container">

  <!-- Setup -->
  <div id="pageSetup" class="page active">
    <div class="grid two">
      <div class="card">
        <div class="titleRow">
          <h2>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙØ±Ù‚</h2>
          <div class="small">ØªØªØ®Ø²Ù† ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§</div>
        </div>
        <div class="field">
          <label>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„</label>
          <input id="team1Name" type="text" placeholder="Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„">
        </div>
        <div class="field">
          <label>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ</label>
          <input id="team2Name" type="text" placeholder="Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ">
        </div>
        <div class="row">
          <button id="resetScores" class="danger">ØªØµÙÙŠØ± Ø§Ù„Ù†Ù‚Ø§Ø·</button>
          <span class="pill">Ù†Ù‚Ø§Ø·: 200 / 400 / 600</span>
        </div>
        <div class="small" style="margin-top:10px">
          âœ… Ù…Ø«Ù„ Ù…Ø§ Ø§ØªÙÙ‚Ù†Ø§: ØªØ¶ØºØ· Â«ØµØ­Â»ØŒ ÙˆØ¨Ø¹Ø¯Ù‡Ø§ ØªØ®ØªØ§Ø± Ø£ÙŠ ÙØ±ÙŠÙ‚ Ø¬Ø§ÙˆØ¨.
        </div>
      </div>

      <div class="card">
        <div class="titleRow">
          <h2>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©</h2>
          <div class="small">Ù…Ø¤Ù‚Øª + Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± + Ø¨Ù†Ùƒ Ø£Ø³Ø¦Ù„Ø©</div>
        </div>

        <div class="field">
          <label>Ù…Ø¯Ø© Ø§Ù„Ù…Ø¤Ù‚Ù‘Øª (Ø«ÙˆØ§Ù†ÙŠ) Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„</label>
          <input id="timerSec" type="number" min="5" step="1" placeholder="Ù…Ø«Ø§Ù„: 30">
        </div>

        <div class="toggle">
          <input id="noRepeatAcross" type="checkbox">
          <label for="noRepeatAcross">Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¹Ø¨Ø± Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
        </div>

        <hr class="sep">

        <div class="row">
          <button id="newBoard" class="primary">Ø¥Ù†Ø´Ø§Ø¡ Ù„ÙˆØ­Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
          <span class="pill" id="bankStats">â€”</span>
        </div>

        <div class="row" style="margin-top:10px">
          <button id="openIO" class="warn">Ø§Ø³ØªÙŠØ±Ø§Ø¯/ØªØµØ¯ÙŠØ± Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</button>
          <button id="clearReports" class="danger">Ù…Ø³Ø­ â€œØ§Ù„Ù…Ø¨Ù„Ù‘Øº Ø¹Ù†Ù‡Ø§â€</button>
        </div>

        <div id="ioPanel" class="subpanel">
          <div class="small">Ø§Ù„ØµÙ‚ JSON Ù„Ù„Ø¨Ù†Ùƒ (Ø£Ùˆ Ø§Ù†Ø³Ø®Ù‡ Ù„Ù„ØªØµØ¯ÙŠØ±)</div>
          <textarea id="ioText" placeholder='[{"cat":"Ø£Ù†Ù…ÙŠ: Naruto","tier":"hard","q":"...","a":"...","img":""}]'></textarea>
          <div class="row" style="margin-top:10px">
            <button id="exportBank">ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ</button>
            <button id="importBank" class="primary">Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØªØ·Ø¨ÙŠÙ‚</button>
          </div>
          <div class="small" style="margin-top:8px">
            ØµÙŠØºØ© Ø§Ù„Ø³Ø¤Ø§Ù„: cat + tier(easy/medium/hard) + q + a (+ img Ø§Ø®ØªÙŠØ§Ø±ÙŠ).  
            Ø§Ù„Ù†Ù‚Ø§Ø· ØªÙØ­Ø¯Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø­Ø³Ø¨ tier (200/400/600) Ù„Ø¶Ø¨Ø· Ø§Ù„Ù…Ø³ØªÙˆÙ‰.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Select -->
  <div id="pageSelect" class="page">
    <div class="card">
      <div class="titleRow">
        <h2>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª (3 Ø¥Ù„Ù‰ 6)</h2>
        <div class="small">Ù„Ùˆ Ø§Ø®ØªØ±Øª Ø£Ù‚Ù„ Ù…Ù† 6ØŒ ÙŠÙƒÙ…Ù„ Ø§Ù„Ø¨Ø§Ù‚ÙŠ Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§</div>
      </div>

      <div class="row" style="margin-bottom:10px">
        <span class="pill" id="selCount">0 Ù…Ø®ØªØ§Ø±</span>
        <span class="pill">Ù…Ù…Ù†ÙˆØ¹ ØªÙƒØ±Ø§Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„ÙˆØ­Ø© 100%</span>
      </div>

      <div id="catsGrid" class="catsGrid"></div>

      <hr class="sep">
      <div class="row">
        <button id="confirmCats" class="primary">ØªØ£ÙƒÙŠØ¯ + Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù„ÙˆØ­Ø©</button>
        <button id="randomCats">Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ</button>
        <button id="clearCats" class="danger">Ù…Ø³Ø­ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±</button>
      </div>
    </div>
  </div>

  <!-- Game -->
  <div id="pageGame" class="page">
    <div class="scorebar">
      <div class="scorebox"><span class="name" id="t1N">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„</span> <span class="score" id="t1S">0</span></div>
      <div class="scorebox"><span class="timer" id="timer">00:00</span> <span class="pill" id="timerState">Ø¬Ø§Ù‡Ø²</span></div>
      <div class="scorebox"><span class="name" id="t2N">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ</span> <span class="score" id="t2S">0</span></div>
    </div>

    <div class="card">
      <div class="titleRow">
        <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©</h2>
        <div class="small" id="boardMeta">â€”</div>
      </div>
      <div id="board" class="board"></div>
    </div>
  </div>
</div>

<!-- Modal -->
<div id="modal" class="modal">
  <div class="modalCard">
    <div class="modalTop">
      <div class="meta">
        <span class="pill" id="mCat"></span>
        <span class="pill" id="mPts"></span>
      </div>
      <div class="row">
        <button id="mReport" class="warn">ğŸš© Ø¨Ù„Ø§Øº: Ø³Ø¤Ø§Ù„ ØºÙ„Ø·/Ø³ÙŠØ¡</button>
        <button id="mClose">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
    </div>
    <div class="modalBody">
      <p class="qtext" id="mQ"></p>
      <img id="mImg" class="qimg" style="display:none">
      <div id="mAnsBox" class="ans">
        <div class="lbl">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</div>
        <div class="aval" id="mA"></div>
      </div>

      <div class="actions">
        <button id="mShow" class="primary">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</button>
        <button id="mCorrect" class="good">ØµØ­ âœ…</button>
        <button id="mWrong" class="danger">ØºÙ„Ø· âŒ</button>
      </div>

      <div id="panelWho" class="subpanel">
        <div style="font-weight:900">Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù„ÙŠ Ø¬Ø§ÙˆØ¨ ØµØ­ØŸ</div>
        <div class="teamBtns">
          <button id="awardT1" class="good"></button>
          <button id="awardT2" class="good"></button>
          <button id="awardNone" class="danger">Ù„Ø§ Ø£Ø­Ø¯</button>
        </div>
      </div>

      <div id="panelSteal" class="subpanel">
        <div style="font-weight:900">Ø³Ø±Ù‚Ø©ØŸ (Ø¥Ø°Ø§ ÙØ±ÙŠÙ‚ Ø«Ø§Ù†ÙŠ Ø¬Ø§ÙˆØ¨ ØµØ­)</div>
        <div class="teamBtns">
          <button id="stealT1"></button>
          <button id="stealT2"></button>
          <button id="stealNone" class="danger">Ù„Ø§ Ø³Ø±Ù‚Ø©</button>
        </div>
      </div>

      <div class="small" style="margin-top:10px">
        200 ÙˆØ³Ø· â€¢ 400 ØµØ¹Ø¨ â€¢ 600 Ø´Ø¨Ù‡ Ù…Ø³ØªØ­ÙŠÙ„ â€” Ù…Ø¶Ø¨ÙˆØ· Ø¹Ù† Ø·Ø±ÙŠÙ‚ tier Ø¯Ø§Ø®Ù„ Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©.
      </div>
    </div>
  </div>
</div>

<script>
/* ===========================
   FINAL: Ù…Ø­Ø±Ùƒ Ù‚ÙˆÙŠ Ø¶Ø¯ Ø§Ù„ØªÙƒØ±Ø§Ø±
   + Ø¨Ù„Ø§Øº + Ø§Ø³ØªÙŠØ±Ø§Ø¯/ØªØµØ¯ÙŠØ±
=========================== */

// ====== Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ®Ø²ÙŠÙ†
const K = {
  settings:"sj_final_settings_v9",
  scores:"sj_final_scores_v9",
  selection:"sj_final_selection_v9",
  board:"sj_final_board_v9",
  usedGlobal:"sj_final_used_global_v9",
  usedCells:"sj_final_used_cells_v9",
  reported:"sj_final_reported_v9",
  bankUser:"sj_final_bank_user_v9"
};

function $(id){ return document.getElementById(id); }
function loadJSON(key, fallback){
  try{ const v = localStorage.getItem(key); return v ? JSON.parse(v) : fallback; }
  catch(e){ return fallback; }
}
function saveJSON(key, val){ localStorage.setItem(key, JSON.stringify(val)); }

function getSettings(){
  return loadJSON(K.settings, {team1:"Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„", team2:"Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ", timer:30, noRepeat:false});
}
function setSettings(s){ saveJSON(K.settings, s); }
function getScores(){ return loadJSON(K.scores, {t1:0,t2:0}); }
function setScores(sc){ saveJSON(K.scores, sc); renderScore(); }

function clearAll(){
  Object.values(K).forEach(k=>localStorage.removeItem(k));
  location.reload();
}

// ====== Ø¨Ù†Ùƒ Ù…Ø«Ø§Ù„ (ØµØºÙŠØ±) + Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯ (Ø§Ù„ÙƒØ¨ÙŠØ±)
const DEFAULT_BANK = [
  // ØµÙŠØºØ© Ù…ÙˆØ­Ø¯Ø©: tier ÙŠØ­Ø¯Ø¯ Ø§Ù„ØµØ¹ÙˆØ¨Ø© (easy/medium/hard)
  {cat:"Ø£Ù†Ù…ÙŠ: Naruto", tier:"easy",  q:"Ù…Ø§ Ø§Ø³Ù… Ø¹Ø§Ø¦Ù„Ø© Ù†Ø§Ø±ÙˆØªÙˆØŸ", a:"Ø£ÙˆØ²ÙˆÙ…Ø§ÙƒÙŠ"},
  {cat:"Ø£Ù†Ù…ÙŠ: Naruto", tier:"medium",q:"Ù…Ø§ Ø§Ø³Ù… Ø¹Ø§Ø¦Ù„Ø© Ù…ÙŠÙ†Ø§ØªÙˆØŸ", a:"Ù†Ø§Ù…ÙŠÙƒØ§Ø²ÙŠ"},
  {cat:"Ø£Ù†Ù…ÙŠ: Naruto", tier:"hard",  q:"Ù…Ø§ Ø§Ø³Ù… Ù„Ù‚Ø¨ ÙƒØ§ÙƒØ§Ø´ÙŠ Ø§Ù„Ø´Ù‡ÙŠØ±ØŸ", a:"Ø§Ù„Ù†ÙŠÙ†Ø¬Ø§ Ø§Ù„Ù†Ø§Ø³Ø®"},

  {cat:"Ø£Ù†Ù…ÙŠ: Attack on Titan", tier:"easy",  q:"Ù…Ø§ Ø§Ø³Ù… Ø¹Ø§Ø¦Ù„Ø© Ù„ÙŠÙØ§ÙŠØŸ", a:"Ø£ÙƒØ±Ù…Ø§Ù†"},
  {cat:"Ø£Ù†Ù…ÙŠ: Attack on Titan", tier:"medium",q:"Ù…Ø§ Ø§Ø³Ù… ÙÙŠÙ„Ù‚ Ø§Ù„Ø¬ÙŠØ´ Ø§Ù„Ø°ÙŠ ÙŠÙ†ØªÙ…ÙŠ Ù„Ù‡ Ø¥ÙŠØ±ÙˆÙŠÙ†ØŸ", a:"ÙÙŠÙ„Ù‚ Ø§Ù„Ø§Ø³ØªØ·Ù„Ø§Ø¹"},
  {cat:"Ø£Ù†Ù…ÙŠ: Attack on Titan", tier:"hard",  q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø¹Ø§ØµÙ…Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø£Ø³ÙˆØ§Ø± (Ø­Ø³Ø¨ Ø§Ù„Ø£Ù†Ù…ÙŠ)ØŸ", a:"Ù…ÙŠØªØ±Ø§Ø³"},

  {cat:"ÙƒØ±Ø© Ù‚Ø¯Ù…: ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…", tier:"easy",  q:"Ù…Ù† ÙØ§Ø² Ø¨ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù… 2022ØŸ", a:"Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†"},
  {cat:"ÙƒØ±Ø© Ù‚Ø¯Ù…: ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…", tier:"medium",q:"ÙÙŠ Ø£ÙŠ Ø¯ÙˆÙ„Ø© Ø£Ù‚ÙŠÙ… ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù… 2022ØŸ", a:"Ù‚Ø·Ø±"},
  {cat:"ÙƒØ±Ø© Ù‚Ø¯Ù…: ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…", tier:"hard",  q:"Ù…Ù† Ø³Ø¬Ù„ Ù‡Ø§ØªØ±ÙŠÙƒ ÙÙŠ Ù†Ù‡Ø§Ø¦ÙŠ 2022ØŸ", a:"ÙƒÙŠÙ„ÙŠØ§Ù† Ù…Ø¨Ø§Ø¨ÙŠ"},

  {cat:"Ø¹ÙˆØ§ØµÙ… Ø§Ù„Ø¹Ø±Ø¨", tier:"easy",  q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªØŸ", a:"Ø£Ø¨ÙˆØ¸Ø¨ÙŠ"},
  {cat:"Ø¹ÙˆØ§ØµÙ… Ø§Ù„Ø¹Ø±Ø¨", tier:"medium",q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© Ø¹ÙÙ…Ø§Ù†ØŸ", a:"Ù…Ø³Ù‚Ø·"},
  {cat:"Ø¹ÙˆØ§ØµÙ… Ø§Ù„Ø¹Ø±Ø¨", tier:"hard",  q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø±ØŸ", a:"Ù…ÙˆØ±ÙˆÙ†ÙŠ"},

  {cat:"Ø£Ø¯Ø¨", tier:"easy",  q:"Ù…Ø§ Ø§Ø³Ù… Ø¹Ù„Ù… Ù‚ÙŠØ§Ø³ Ø§Ù„Ø´Ø¹Ø± Ø§Ù„Ø¹Ø±Ø¨ÙŠØŸ", a:"Ø§Ù„Ø¹ÙØ±ÙˆØ¶"},
  {cat:"Ø£Ø¯Ø¨", tier:"medium",q:"Ù…Ù† ÙˆØ§Ø¶Ø¹ Ø¹Ù„Ù… Ø§Ù„Ø¹ÙØ±ÙˆØ¶ØŸ", a:"Ø§Ù„Ø®Ù„ÙŠÙ„ Ø¨Ù† Ø£Ø­Ù…Ø¯ Ø§Ù„ÙØ±Ø§Ù‡ÙŠØ¯ÙŠ"},
  {cat:"Ø£Ø¯Ø¨", tier:"hard",  q:"Ù…Ø§ Ø§Ø³Ù… Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù‚ØµÙŠØ¯Ø©ØŸ", a:"Ø§Ù„Ù…Ø·Ù„Ø¹"},
];

// ====== ØªØ­Ù…ÙŠÙ„ Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù† ÙˆÙØ¬Ø¯
function loadBank(){
  const user = loadJSON(K.bankUser, null);
  const raw = Array.isArray(user) && user.length ? user : DEFAULT_BANK;

  // ØªÙ†Ø¸ÙŠÙ + ØªÙˆØ­ÙŠØ¯ + IDs + ØªØ­ÙˆÙŠÙ„ tier -> pts
  const reported = new Set(loadJSON(K.reported, []));
  const seen = new Set();
  const out = [];

  for (const it of raw){
    if (!it || !it.cat || !it.q || !it.a) continue;
    const tier = (it.tier||"medium").toLowerCase();
    const pts = tier==="easy" ? 200 : tier==="hard" ? 600 : 400;

    const cat = String(it.cat).trim();
    const q = String(it.q).trim();
    const a = String(it.a).trim();
    const img = it.img ? String(it.img) : "";

    const id = makeId({cat, q, a, img, tier});
    if (reported.has(id)) continue;            // Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„Ù…Ø¨Ù„Ù‘Øº Ø¹Ù†Ù‡Ø§
    if (seen.has(id)) continue;                // Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± ÙÙŠ Ø§Ù„Ø¨Ù†Ùƒ Ù†ÙØ³Ù‡
    seen.add(id);

    out.push({id, cat, q, a, img, tier, pts});
  }
  return out;
}

function makeId(o){
  // ID Ø«Ø§Ø¨Øª Ù‚ÙˆÙŠ (Ù…Ù† Ù†ÙØ³ Ø§Ù„Ø³Ø¤Ø§Ù„)
  const s = `${o.cat}|${o.tier||""}|${o.q}|${o.a}|${o.img||""}`;
  let h=0;
  for (let i=0;i<s.length;i++){ h = (h*31 + s.charCodeAt(i)) >>> 0; }
  return "q" + h.toString(16).padStart(8,"0");
}

let BANK = loadBank();

// ====== ØªØµÙ†ÙŠÙ Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø© + tiers
function buildIndex(){
  const byCat = new Map();
  for (const q of BANK){
    if (!byCat.has(q.cat)) byCat.set(q.cat, {easy:[], medium:[], hard:[]});
    byCat.get(q.cat)[q.tier].push(q);
  }
  // ØªØ±ØªÙŠØ¨ Ø«Ø§Ø¨Øª Ø¯Ø§Ø®Ù„ ÙƒÙ„ tier (Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø®ÙÙŠÙ Ø­Ø³Ø¨ id)
  for (const [cat, grp] of byCat.entries()){
    for (const t of ["easy","medium","hard"]){
      grp[t].sort((a,b)=>a.id.localeCompare(b.id));
    }
  }
  return byCat;
}

let INDEX = buildIndex();

// ====== ØµÙØ­Ø§Øª
function showPage(name){
  ["Setup","Select","Game"].forEach(p=>$("page"+p).classList.remove("active"));
  $("page"+name).classList.add("active");
}

// ====== Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
function refreshStats(){
  const cats = Array.from(INDEX.keys());
  $("bankStats").textContent = `${cats.length} ØªØµÙ†ÙŠÙ â€¢ ${BANK.length} Ø³Ø¤Ø§Ù„`;
}

// ====== Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
function initSetup(){
  const s = getSettings();
  $("team1Name").value = s.team1;
  $("team2Name").value = s.team2;
  $("timerSec").value = s.timer;
  $("noRepeatAcross").checked = !!s.noRepeat;

  $("team1Name").addEventListener("input", ()=>{
    const ns = getSettings(); ns.team1 = $("team1Name").value.trim() || "Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„";
    setSettings(ns); renderScore();
  });
  $("team2Name").addEventListener("input", ()=>{
    const ns = getSettings(); ns.team2 = $("team2Name").value.trim() || "Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ";
    setSettings(ns); renderScore();
  });
  $("timerSec").addEventListener("input", ()=>{
    const ns = getSettings(); ns.timer = Math.max(5, parseInt($("timerSec").value||"30",10));
    setSettings(ns);
  });
  $("noRepeatAcross").addEventListener("change", ()=>{
    const ns = getSettings(); ns.noRepeat = $("noRepeatAcross").checked;
    setSettings(ns);
  });

  $("resetScores").onclick = ()=> setScores({t1:0,t2:0});
  $("newBoard").onclick = ()=> showPage("Select");

  $("openIO").onclick = ()=> $("ioPanel").classList.toggle("show");

  $("exportBank").onclick = ()=>{
    $("ioText").value = JSON.stringify(loadJSON(K.bankUser, DEFAULT_BANK), null, 2);
    $("ioText").focus(); $("ioText").select();
  };

  $("importBank").onclick = ()=>{
    try{
      const arr = JSON.parse($("ioText").value);
      if (!Array.isArray(arr) || arr.length<10) return alert("Ø§Ù„Ø¨Ù†Ùƒ ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ ØµØºÙŠØ± Ø¬Ø¯Ù‹Ø§.");
      saveJSON(K.bankUser, arr);
      // rebuild
      BANK = loadBank();
      INDEX = buildIndex();
      refreshStats();
      renderCats();
      alert("ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨Ù†Ùƒ Ø¨Ù†Ø¬Ø§Ø­ âœ…");
    }catch(e){
      alert("JSON ØºÙŠØ± ØµØ­ÙŠØ­.");
    }
  };

  $("clearReports").onclick = ()=>{
    if (!confirm("Ø£ÙƒÙŠØ¯ ØªÙ…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø¨Ù„Ù‘Øº Ø¹Ù†Ù‡Ø§ØŸ")) return;
    localStorage.removeItem(K.reported);
    BANK = loadBank();
    INDEX = buildIndex();
    refreshStats();
    renderCats();
    alert("ØªÙ… âœ…");
  };

  refreshStats();
}

// ====== Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª
function allCats(){
  const cats = Array.from(INDEX.keys());
  cats.sort((a,b)=>a.localeCompare(b));
  return cats;
}
let selected = new Set(loadJSON(K.selection, []));

function renderCats(){
  const grid = $("catsGrid");
  grid.innerHTML = "";
  for (const cat of allCats()){
    const grp = INDEX.get(cat);
    const n = grp.easy.length + grp.medium.length + grp.hard.length;

    const div = document.createElement("div");
    div.className = "card catCard " + (selected.has(cat) ? "on":"off");
    div.innerHTML = `
      <div style="display:flex;justify-content:space-between;gap:8px;align-items:center">
        <div style="font-weight:1000">${cat}</div>
        <div class="pill">${n} Ø³Ø¤Ø§Ù„</div>
      </div>
      <div class="small" style="margin-top:6px">200: ${grp.easy.length} â€¢ 400: ${grp.medium.length} â€¢ 600: ${grp.hard.length}</div>
    `;
    div.onclick = ()=>{
      if (selected.has(cat)) selected.delete(cat);
      else{
        if (selected.size>=6) return alert("Ù…Ø³Ù…ÙˆØ­ 6 ØªØµÙ†ÙŠÙØ§Øª ÙÙ‚Ø·");
        selected.add(cat);
      }
      saveJSON(K.selection, Array.from(selected));
      $("selCount").textContent = `${selected.size} Ù…Ø®ØªØ§Ø±`;
      renderCats();
    };
    grid.appendChild(div);
  }
  $("selCount").textContent = `${selected.size} Ù…Ø®ØªØ§Ø±`;
}

function randomCats(){
  const pool = allCats();
  selected = new Set();
  while(selected.size<6 && pool.length){
    selected.add(pool.splice(Math.floor(Math.random()*pool.length),1)[0]);
  }
  saveJSON(K.selection, Array.from(selected));
  renderCats();
}
function clearCats(){
  selected = new Set();
  saveJSON(K.selection, []);
  renderCats();
}

// ====== Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± Ø¹Ø¨Ø± Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
function usedGlobalSet(){
  const s = getSettings();
  if (!s.noRepeat) return new Set();
  return new Set(loadJSON(K.usedGlobal, []));
}
function saveUsedGlobal(set){
  const s = getSettings();
  if (!s.noRepeat) return;
  saveJSON(K.usedGlobal, Array.from(set));
}

// ====== Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø± 100% Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„ÙˆØ­Ø©
function pickUnique(list, k, usedIds){
  // list: array, usedIds: Set
  const pool = list.filter(x=>!usedIds.has(x.id));
  // Ù„Ùˆ Ù…Ø§ ÙŠÙƒÙÙŠØŒ Ø±Ø¬Ø¹ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø¨Ø³ Ù„Ø³Ù‡ Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„ÙˆØ­Ø©
  const source = pool.length>=k ? pool : list.filter(x=>!usedIds.has(x.id));
  const out = [];
  const tmp = source.slice();
  while(out.length<k && tmp.length){
    const i = Math.floor(Math.random()*tmp.length);
    const q = tmp.splice(i,1)[0];
    if (!usedIds.has(q.id)){
      usedIds.add(q.id);
      out.push(q);
    }
  }
  return out;
}

const POINTS = [200,200,400,400,600,600];

function buildBoard(){
  if (selected.size < 3) return alert("Ø§Ø®ØªØ± 3 ØªØµÙ†ÙŠÙØ§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");
  let cats = Array.from(selected);

  if (cats.length < 6){
    const pool = allCats().filter(c=>!selected.has(c));
    while(cats.length < 6 && pool.length){
      cats.push(pool.splice(Math.floor(Math.random()*pool.length),1)[0]);
    }
  }
  cats = cats.slice(0,6);

  const usedG = usedGlobalSet();
  const usedInBoard = new Set(); // ÙŠÙ…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„ÙˆØ­Ø© Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§
  // Ø£Ø¶Ù usedG Ø¥Ø°Ø§ ØªØ¨ÙŠ Ù…Ù†Ø¹ Ø¹Ø¨Ø± Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨
  for (const id of usedG) usedInBoard.add(id);

  const board = {cats:[], cells:{}};

  for (const cat of cats){
    const grp = INDEX.get(cat);
    // 2 easy, 2 medium, 2 hard â€” Ù‡Ø°Ø§ Ø§Ù„Ù„ÙŠ ÙŠØ«Ø¨Øª â€œØ§Ù„Ù…Ø³ØªÙˆÙ‰â€
    const picked = []
      .concat(pickUnique(grp.easy,   2, usedInBoard))
      .concat(pickUnique(grp.medium, 2, usedInBoard))
      .concat(pickUnique(grp.hard,   2, usedInBoard));

    if (picked.length < 6){
      // Ù„Ùˆ Ø§Ù„ØªØµÙ†ÙŠÙ Ù†Ø§Ù‚Øµ tier Ù…Ø¹ÙŠÙ†: ÙƒÙ…Ù„ Ù…Ù† Ø£ÙŠ tier Ø¨Ø³ Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø±
      const all = grp.easy.concat(grp.medium, grp.hard);
      picked.push(...pickUnique(all, 6-picked.length, usedInBoard));
    }

    board.cats.push(cat);
    for (let r=0;r<6;r++){
      board.cells[`${cat}|${r}`] = picked[r];
    }
  }

  saveJSON(K.board, board);
  saveJSON(K.usedCells, {}); // Ù„ÙˆØ­Ø© Ø¬Ø¯ÙŠØ¯Ø©
  $("boardMeta").textContent = `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${new Date().toLocaleString('ar')}`;
  renderBoard();
  showPage("Game");
}

// ====== Ø¹Ø±Ø¶ Ø§Ù„Ù„ÙˆØ­Ø©
function renderBoard(){
  const boardEl = $("board");
  boardEl.innerHTML = "";
  const board = loadJSON(K.board, null);
  if (!board){
    boardEl.innerHTML = `<div class="small">Ù…Ø§ÙÙŠ Ù„ÙˆØ­Ø© Ø¨Ø¹Ø¯ â€” Ø±ÙˆØ­ "Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª"</div>`;
    return;
  }
  const usedCells = loadJSON(K.usedCells, {});
  for (const cat of board.cats){
    const col = document.createElement("div");
    col.className = "col";
    const head = document.createElement("div");
    head.className = "colHead";
    head.textContent = cat;
    col.appendChild(head);

    POINTS.forEach((pts,r)=>{
      const key = `${cat}|${r}`;
      const q = board.cells[key];
      const cell = document.createElement("div");
      cell.className = "cell";
      const b = document.createElement("button");
      b.textContent = pts;
      b.className = (pts===200?"p200":pts===400?"p400":"p600") + (usedCells[key]?" used":"");
      b.onclick = ()=>{
        if (usedCells[key]) return;
        openQuestion(cat, pts, r, q);
      };
      cell.appendChild(b);
      col.appendChild(cell);
    });

    boardEl.appendChild(col);
  }
}

// ====== Ø§Ù„Ù…Ø¤Ù‚Øª + Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ + Ø§Ù„Ù†Ù‚Ø§Ø·
let current=null;
let timerInt=null;
let timerLeft=0;

function tickTimer(){
  const m = String(Math.floor(timerLeft/60)).padStart(2,"0");
  const s = String(timerLeft%60).padStart(2,"0");
  $("timer").textContent = `${m}:${s}`;
}
function startTimer(sec){
  clearInterval(timerInt);
  timerLeft = sec;
  $("timerState").textContent = "ÙŠØ´ØªØºÙ„";
  tickTimer();
  timerInt = setInterval(()=>{
    timerLeft--;
    tickTimer();
    if (timerLeft<=0){
      clearInterval(timerInt);
      $("timerState").textContent = "Ø§Ù†ØªÙ‡Ù‰";
    }
  },1000);
}
function stopTimer(){
  clearInterval(timerInt);
  $("timerState").textContent = "Ø¬Ø§Ù‡Ø²";
}

function openQuestion(cat, pts, row, q){
  current = {cat, pts, row, q};
  $("mCat").textContent = cat;
  $("mPts").textContent = `${pts} Ù†Ù‚Ø·Ø©`;
  $("mQ").textContent = q.q;
  $("mA").textContent = q.a;

  $("mAnsBox").classList.remove("show");
  $("panelWho").classList.remove("show");
  $("panelSteal").classList.remove("show");

  if (q.img){
    $("mImg").src = q.img;
    $("mImg").style.display = "block";
  } else {
    $("mImg").style.display = "none";
  }

  $("modal").classList.add("show");
  startTimer(getSettings().timer || 30);
}

function markUsed(){
  // Ø®Ù„ÙŠØ©
  const usedCells = loadJSON(K.usedCells, {});
  usedCells[`${current.cat}|${current.row}`] = true;
  saveJSON(K.usedCells, usedCells);

  // Ø³Ø¤Ø§Ù„ Ø¹Ø§Ù„Ù…ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  const s = getSettings();
  if (s.noRepeat){
    const usedG = usedGlobalSet();
    usedG.add(current.q.id);
    saveUsedGlobal(usedG);
  }
  renderBoard();
}

function closeModal(){
  stopTimer();
  $("modal").classList.remove("show");
  $("mAnsBox").classList.remove("show");
  $("panelWho").classList.remove("show");
  $("panelSteal").classList.remove("show");
  current=null;
}

function renderScore(){
  const s = getSettings();
  const sc = getScores();
  $("t1N").textContent = s.team1;
  $("t2N").textContent = s.team2;
  $("t1S").textContent = sc.t1;
  $("t2S").textContent = sc.t2;

  $("awardT1").textContent = s.team1;
  $("awardT2").textContent = s.team2;
  $("stealT1").textContent = s.team1;
  $("stealT2").textContent = s.team2;
}

function award(team){
  const sc = getScores();
  if (team==="t1") sc.t1 += current.pts;
  if (team==="t2") sc.t2 += current.pts;
  setScores(sc);
  markUsed();
  closeModal();
}
function noAward(){
  markUsed();
  closeModal();
}

// ====== Ø¨Ù„Ø§Øº Ø³Ø¤Ø§Ù„ ØºÙ„Ø·/Ø³ÙŠØ¡
function reportCurrent(){
  if (!current) return;
  if (!confirm("ØªØ¨ØºÙŠ ØªØ³ÙˆÙŠ Ø¨Ù„Ø§ØºØŸ Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨ÙŠÙ†Ø´Ø§Ù„ Ù…Ù† Ø§Ù„Ø¨Ù†Ùƒ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ.")) return;
  const arr = loadJSON(K.reported, []);
  if (!arr.includes(current.q.id)) arr.push(current.q.id);
  saveJSON(K.reported, arr);

  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ù†Ùƒ ÙˆØ§Ù„ÙÙ‡Ø±Ø³
  BANK = loadBank();
  INDEX = buildIndex();
  refreshStats();
  renderCats();

  // Ø§Ø¹ØªØ¨Ø±Ù‡ Ù…Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© ÙˆØ§ØºÙ„Ù‚
  markUsed();
  closeModal();
  alert("ØªÙ… âœ… Ø§Ù†Ø´Ø§Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„.");
}

// ====== Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
$("goSetup").onclick = ()=>showPage("Setup");
$("goSelect").onclick = ()=>{ showPage("Select"); renderCats(); };
$("goGame").onclick = ()=>{ showPage("Game"); renderBoard(); };
$("wipe").onclick = ()=>{ if(confirm("Ø£ÙƒÙŠØ¯ ØªØ¨ØºÙŠ ØªÙ…Ø³Ø­ ÙƒÙ„ Ø´ÙŠØŸ")) clearAll(); };

$("confirmCats").onclick = buildBoard;
$("randomCats").onclick = randomCats;
$("clearCats").onclick = clearCats;

$("mClose").onclick = closeModal;
$("mReport").onclick = reportCurrent;
$("modal").addEventListener("click", e=>{ if(e.target.id==="modal") closeModal(); });

$("mShow").onclick = ()=> $("mAnsBox").classList.add("show");

// Ù…Ø«Ù„ Ù…Ø§ Ø§ØªÙÙ‚Ù†Ø§: Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ±ÙŠÙ‚ Ø¨Ø¹Ø¯ "ØµØ­"
$("mCorrect").onclick = ()=>{
  $("mAnsBox").classList.add("show");
  $("panelSteal").classList.remove("show");
  $("panelWho").classList.add("show");
};
$("mWrong").onclick = ()=>{
  $("mAnsBox").classList.add("show");
  $("panelWho").classList.remove("show");
  $("panelSteal").classList.add("show");
};

$("awardT1").onclick = ()=>award("t1");
$("awardT2").onclick = ()=>award("t2");
$("awardNone").onclick = ()=>noAward();

$("stealT1").onclick = ()=>award("t1");
$("stealT2").onclick = ()=>award("t2");
$("stealNone").onclick = ()=>noAward();

// ====== ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ÙŠ
initSetup();
renderScore();
renderCats();
renderBoard();
timerLeft = getSettings().timer || 30;
tickTimer();
</script>

</body>
</html>
