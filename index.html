<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SeenJeem - نسخة قديمة ستايل</title>
  <style>
    :root{
      --bg:#0f1115;
      --card:#171a22;
      --card2:#1f2330;
      --text:#f3f4f6;
      --muted:#aab0c0;
      --accent:#ff7a45;
      --accent2:#ffb703;
      --good:#2dd4bf;
      --bad:#fb7185;
      --line:#2a2f3d;
    }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial}
    body{margin:0;background:linear-gradient(180deg,#0c0e13, #0f1115 30%, #0f1115);color:var(--text)}
    header{
      position:sticky;top:0;z-index:5;
      background:rgba(15,17,21,.92);backdrop-filter: blur(10px);
      border-bottom:1px solid var(--line);
    }
    .wrap{max-width:1100px;margin:0 auto;padding:14px 16px}
    .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .spacer{flex:1}
    .title{font-weight:800;letter-spacing:.2px}
    .pill{
      padding:10px 12px;border:1px solid var(--line);
      background:var(--card);color:var(--text);
      border-radius:14px;cursor:pointer;
      display:inline-flex;gap:8px;align-items:center;
      user-select:none
    }
    .pill:hover{border-color:#3a4157}
    .pill.primary{background:linear-gradient(135deg,var(--accent),#ff4d6d);border:none}
    .pill.ghost{background:transparent}
    .pill.small{padding:8px 10px;border-radius:12px;font-size:14px}
    .grid{
      display:grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap:12px;
    }
    @media (max-width: 950px){ .grid{grid-template-columns: repeat(3,1fr);} }
    @media (max-width: 700px){ .grid{grid-template-columns: repeat(2,1fr);} }
    @media (max-width: 420px){ .grid{grid-template-columns: 1fr;} }

    .card{
      background:linear-gradient(180deg,var(--card), #141823);
      border:1px solid var(--line);
      border-radius:18px;
      overflow:hidden;
      cursor:pointer;
      min-height:120px;
      display:flex;flex-direction:column;
      transition:transform .12s ease, border-color .12s ease;
    }
    .card:hover{transform:translateY(-2px);border-color:#3a4157}
    .thumb{
      height:86px;
      background:radial-gradient(circle at 30% 20%, #2d3346, #141823);
      display:flex;align-items:center;justify-content:center;
      border-bottom:1px solid var(--line);
      color:var(--muted);
      font-weight:700;
    }
    .card .info{padding:12px}
    .card .name{font-weight:800}
    .card .meta{color:var(--muted);font-size:13px;margin-top:4px}

    .section{margin-top:18px}
    .bar{
      display:flex;align-items:center;gap:10px;flex-wrap:wrap;
      margin:18px 0 10px;
    }
    .chip{
      padding:8px 10px;border-radius:999px;
      background:var(--card2);border:1px solid var(--line);
      color:var(--muted);font-size:13px
    }

    .scoreboard{
      display:flex;gap:10px;flex-wrap:wrap;align-items:stretch;
    }
    .team{
      flex:1;min-width:190px;
      background:linear-gradient(180deg,var(--card), #141823);
      border:1px solid var(--line);
      border-radius:18px;
      padding:12px;
      display:flex;flex-direction:column;gap:10px;
    }
    .team h3{margin:0;font-size:15px;color:var(--muted);font-weight:700}
    .team .nameRow{display:flex;gap:8px;align-items:center}
    .team input{
      width:100%;
      padding:10px 12px;border-radius:14px;
      border:1px solid var(--line);background:#0f131d;color:var(--text);
      outline:none
    }
    .team .score{
      font-size:28px;font-weight:900;letter-spacing:.5px
    }
    .team .btns{display:flex;gap:8px;flex-wrap:wrap}
    .team .btns button{
      flex:1;
      padding:10px 10px;border-radius:14px;
      border:1px solid var(--line);background:var(--card2);color:var(--text);
      cursor:pointer
    }
    .team .btns button:hover{border-color:#3a4157}
    .team .btns button.plus{border-color:rgba(45,212,191,.4)}
    .team .btns button.minus{border-color:rgba(251,113,133,.35)}
    .muted{color:var(--muted)}

    /* Question grid */
    .qgrid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    @media (max-width: 850px){ .qgrid{grid-template-columns:repeat(2,1fr);} }
    @media (max-width: 470px){ .qgrid{grid-template-columns:1fr;} }
    .qbtn{
      background:linear-gradient(180deg,var(--card), #141823);
      border:1px solid var(--line);
      border-radius:18px;
      padding:14px;
      cursor:pointer;
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      min-height:64px;
    }
    .qbtn:hover{border-color:#3a4157}
    .qbtn.used{opacity:.45;cursor:not-allowed}
    .qbtn .pts{
      font-weight:900;
      color:var(--accent2);
      background:rgba(255,183,3,.10);
      border:1px solid rgba(255,183,3,.25);
      padding:6px 10px;border-radius:999px;
      min-width:74px;text-align:center
    }
    .qbtn .label{font-weight:800}
    .qbtn .sub{color:var(--muted);font-size:13px;margin-top:2px}

    /* Modal */
    .modalBack{
      position:fixed;inset:0;background:rgba(0,0,0,.65);
      display:none;align-items:center;justify-content:center;
      padding:18px;z-index:20
    }
    .modal{
      width:min(920px, 100%);
      background:linear-gradient(180deg,#171a22,#10131b);
      border:1px solid var(--line);
      border-radius:22px;
      overflow:hidden;
    }
    .modalHead{
      padding:12px 14px;
      border-bottom:1px solid var(--line);
      display:flex;align-items:center;gap:10px;flex-wrap:wrap
    }
    .modalHead .tag{
      background:rgba(255,122,69,.14);
      border:1px solid rgba(255,122,69,.3);
      padding:6px 10px;border-radius:999px;
      font-weight:800;font-size:13px
    }
    .modalHead .close{
      margin-right:auto;
      padding:10px 12px;border-radius:14px;
      border:1px solid var(--line);background:transparent;color:var(--text);
      cursor:pointer
    }
    .modalBody{padding:16px}
    .qText{font-size:22px;font-weight:900;line-height:1.5;margin:0 0 14px}
    .imgWrap{margin:10px 0 14px;display:none}
    .imgWrap img{width:100%;max-height:360px;object-fit:contain;border-radius:16px;border:1px solid var(--line);background:#0b0e14}
    .answerBox{
      display:none;
      background:rgba(45,212,191,.10);
      border:1px solid rgba(45,212,191,.35);
      border-radius:18px;
      padding:12px 14px;
      font-size:18px;font-weight:800
    }
    .modalActions{
      display:flex;gap:10px;flex-wrap:wrap;
      padding:14px;
      border-top:1px solid var(--line);
      background:rgba(10,12,18,.55)
    }
    .modalActions button{
      padding:12px 14px;border-radius:16px;
      border:1px solid var(--line);
      background:var(--card2);color:var(--text);
      cursor:pointer;font-weight:800
    }
    .modalActions button.primary{background:linear-gradient(135deg,var(--accent),#ff4d6d);border:none}
    .modalActions button.good{border-color:rgba(45,212,191,.45)}
    .modalActions button.bad{border-color:rgba(251,113,133,.4)}
    .pickTeamRow{display:none;gap:10px;flex-wrap:wrap}
    .pickTeamRow button{flex:1;min-width:140px}
    .toast{
      position:fixed;bottom:16px;right:16px;
      background:rgba(23,26,34,.96);
      border:1px solid var(--line);
      padding:10px 12px;border-radius:14px;
      color:var(--text);display:none;z-index:50
    }
    .hr{height:1px;background:var(--line);margin:14px 0}
    textarea{
      width:100%;min-height:140px;padding:12px;border-radius:16px;
      border:1px solid var(--line);background:#0f131d;color:var(--text);
      outline:none;resize:vertical
    }
  </style>
</head>

<body>
<header>
  <div class="wrap">
    <div class="row">
      <div class="title">SeenJeem — نسخة قديمة (تصنيف ➜ سؤال)</div>
      <div class="spacer"></div>
      <button class="pill ghost" id="btnHome">الرئيسية</button>
      <button class="pill ghost" id="btnSettings">الإعدادات</button>
      <button class="pill" id="btnReset">إعادة تعيين الأسئلة</button>
    </div>
  </div>
</header>

<main class="wrap">

  <!-- SCORE -->
  <section class="section" id="scoreSection">
    <div class="bar">
      <span class="chip">النتيجة تظهر من البداية ✅</span>
      <span class="chip">السؤال ما يعيد نفسه ✅</span>
      <span class="chip">تحديد الفريق بعد "إجابة صحيحة" ✅</span>
    </div>

    <div class="scoreboard" id="scoreboard"></div>
  </section>

  <!-- HOME / CATEGORIES -->
  <section class="section" id="homeSection">
    <div class="bar">
      <span class="chip" id="catsCount">—</span>
      <span class="chip" id="qsCount">—</span>
    </div>
    <div class="grid" id="catsGrid"></div>
  </section>

  <!-- CATEGORY / QUESTIONS -->
  <section class="section" id="catSection" style="display:none">
    <div class="bar">
      <button class="pill ghost" id="btnBack">رجوع</button>
      <div class="spacer"></div>
      <span class="chip" id="catTitleChip">—</span>
      <span class="chip" id="catProgressChip">—</span>
    </div>
    <div class="qgrid" id="qGrid"></div>
  </section>

  <!-- SETTINGS -->
  <section class="section" id="settingsSection" style="display:none">
    <div class="bar">
      <span class="chip">تعديل أسماء الفرق + استيراد بنك أسئلة</span>
    </div>

    <div class="hr"></div>

    <h3 style="margin:0 0 10px">استيراد / تصدير بنك الأسئلة</h3>
    <p class="muted" style="margin:0 0 10px">
      إذا تبي تغير الأسئلة: انسخ JSON وحطه هنا واضغط "استيراد".
      <br>ملاحظة: الاستيراد يستبدل البنك الحالي بالكامل.
    </p>
    <textarea id="bankText" placeholder='الصق JSON هنا...'></textarea>
    <div class="row" style="margin-top:10px">
      <button class="pill primary" id="btnImport">استيراد البنك</button>
      <button class="pill" id="btnExport">تصدير البنك الحالي</button>
      <button class="pill" id="btnResetScores">تصفير النقاط</button>
    </div>

    <div class="hr"></div>

    <h3 style="margin:0 0 10px">خيارات</h3>
    <div class="row">
      <label class="pill small" style="cursor:default">
        <input type="checkbox" id="chkShowAnswersFast" style="accent-color:var(--accent);margin-left:8px">
        إظهار الإجابة مباشرة (اختياري)
      </label>
    </div>
  </section>

</main>

<!-- MODAL -->
<div class="modalBack" id="modalBack">
  <div class="modal">
    <div class="modalHead">
      <span class="tag" id="modalTag">—</span>
      <span class="tag" id="modalPts">—</span>
      <button class="close" id="btnClose">إغلاق</button>
    </div>
    <div class="modalBody">
      <h2 class="qText" id="modalQ">—</h2>
      <div class="imgWrap" id="imgWrap"><img id="modalImg" alt=""></div>
      <div class="answerBox" id="answerBox">—</div>
    </div>
    <div class="modalActions">
      <button class="primary" id="btnReveal">إظهار الإجابة</button>
      <button class="bad" id="btnWrong" style="display:none">إجابة غلط</button>
      <button class="good" id="btnCorrect" style="display:none">إجابة صحيحة</button>

      <div class="pickTeamRow" id="pickTeamRow" style="width:100%">
        <!-- dynamically -->
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
/* =========================================
   1) حط بنك أسئلتك هنا (أو استورده من الإعدادات)
   - img اختياري (رابط صورة)
   - pts 200/400/600 (حدد مستوى السؤال)
   - q/a لازم تكون إجابة مباشرة (مو شرح)
========================================= */
const QUESTION_BANK = {
  meta: { version: "old-style-v1" },
  teams: [
    { id:"T", name:"T", score:0 },
    { id:"R", name:"R", score:0 },
  ],
  categories: [
    {
      id:"movies",
      title:"أفلام",
      thumb:null,
      questions:[
        { id:"mv-200-1", pts:200, q:"من الممثل الذي لعب دور Jack Sparrow؟", a:"جوني ديب", img:null },
        { id:"mv-400-1", pts:400, q:"في أي سنة صدر فيلم Inception؟", a:"2010", img:null },
        { id:"mv-600-1", pts:600, q:"ما اسم شخصية الشرير في The Dark Knight؟", a:"الجوكر", img:null },
      ]
    },
    {
      id:"games",
      title:"ألعاب",
      thumb:null,
      questions:[
        { id:"gm-200-1", pts:200, q:"ما اسم بطل GTA San Andreas؟", a:"CJ (Carl Johnson)", img:null },
        { id:"gm-400-1", pts:400, q:"في أي سنة صدر Assassin's Creed 1؟", a:"2007", img:null },
        { id:"gm-600-1", pts:600, q:"ما اسم الشركة المطوّرة لسلسلة The Legend of Zelda؟", a:"Nintendo", img:null },
      ]
    },
  ]
};

/* =========================================
   تخزين محلي (حفظ النقاط والأسئلة المستخدمة)
========================================= */
const LS_KEY = "seenjeem_oldstyle_state_v1";

function deepClone(o){ return JSON.parse(JSON.stringify(o)); }

function loadState(){
  const raw = localStorage.getItem(LS_KEY);
  if(!raw) return null;
  try { return JSON.parse(raw); } catch(e){ return null; }
}

function saveState(){
  localStorage.setItem(LS_KEY, JSON.stringify(state));
}

function makeInitialState(){
  const base = deepClone(QUESTION_BANK);
  return {
    bank: base,
    used: {},          // used[questionId] = true
    showAnswersFast: false,
  };
}

let state = loadState() || makeInitialState();

/* =========================================
   UI refs
========================================= */
const el = (id)=>document.getElementById(id);
const catsGrid = el("catsGrid");
const catsCount = el("catsCount");
const qsCount = el("qsCount");
const homeSection = el("homeSection");
const catSection = el("catSection");
const settingsSection = el("settingsSection");
const scoreboard = el("scoreboard");

const catTitleChip = el("catTitleChip");
const catProgressChip = el("catProgressChip");
const qGrid = el("qGrid");

const modalBack = el("modalBack");
const modalTag = el("modalTag");
const modalPts = el("modalPts");
const modalQ = el("modalQ");
const answerBox = el("answerBox");
const imgWrap = el("imgWrap");
const modalImg = el("modalImg");

const btnReveal = el("btnReveal");
const btnWrong = el("btnWrong");
const btnCorrect = el("btnCorrect");
const pickTeamRow = el("pickTeamRow");

const toast = el("toast");

/* =========================================
   Router
========================================= */
let currentCategoryId = null;
let currentQuestion = null;

function showToast(msg){
  toast.textContent = msg;
  toast.style.display = "block";
  clearTimeout(showToast._t);
  showToast._t = setTimeout(()=>toast.style.display="none", 1800);
}

function goHome(){
  currentCategoryId = null;
  homeSection.style.display = "";
  catSection.style.display = "none";
  settingsSection.style.display = "none";
  renderAll();
}

function goSettings(){
  homeSection.style.display = "none";
  catSection.style.display = "none";
  settingsSection.style.display = "";
  el("bankText").value = JSON.stringify(state.bank, null, 2);
  el("chkShowAnswersFast").checked = !!state.showAnswersFast;
}

function goCategory(catId){
  currentCategoryId = catId;
  homeSection.style.display = "none";
  settingsSection.style.display = "none";
  catSection.style.display = "";
  renderCategory();
}

/* =========================================
   Render
========================================= */
function countAllQuestions(bank){
  let n=0;
  for(const c of bank.categories) n += (c.questions?.length||0);
  return n;
}
function countUsedInCategory(cat){
  let n=0;
  for(const q of cat.questions) if(state.used[q.id]) n++;
  return n;
}
function getCategory(catId){
  return state.bank.categories.find(c=>c.id===catId);
}

function renderScoreboard(){
  scoreboard.innerHTML = "";
  for(const t of state.bank.teams){
    const box = document.createElement("div");
    box.className = "team";
    box.innerHTML = `
      <h3>الفريق</h3>
      <div class="nameRow">
        <input value="${escapeHtml(t.name)}" data-teamname="${t.id}" />
      </div>
      <div class="score" data-score="${t.id}">${t.score}</div>
      <div class="btns">
        <button class="minus" data-minus="${t.id}">-100</button>
        <button class="plus" data-plus="${t.id}">+100</button>
      </div>
    `;
    scoreboard.appendChild(box);
  }

  // name edits
  scoreboard.querySelectorAll("input[data-teamname]").forEach(inp=>{
    inp.addEventListener("input",(e)=>{
      const id = e.target.getAttribute("data-teamname");
      const team = state.bank.teams.find(x=>x.id===id);
      team.name = e.target.value;
      saveState();
    });
  });
  // quick +/- 100
  scoreboard.querySelectorAll("button[data-plus]").forEach(b=>{
    b.addEventListener("click",(e)=>{
      const id = e.target.getAttribute("data-plus");
      adjustTeamScore(id, +100);
    });
  });
  scoreboard.querySelectorAll("button[data-minus]").forEach(b=>{
    b.addEventListener("click",(e)=>{
      const id = e.target.getAttribute("data-minus");
      adjustTeamScore(id, -100);
    });
  });
}

function renderHome(){
  const bank = state.bank;
  const cats = bank.categories || [];
  catsCount.textContent = `التصنيفات: ${cats.length}`;
  qsCount.textContent = `إجمالي الأسئلة: ${countAllQuestions(bank)}`;

  catsGrid.innerHTML = "";
  for(const c of cats){
    const usedN = countUsedInCategory(c);
    const total = c.questions.length;
    const card = document.createElement("div");
    card.className = "card";
    card.addEventListener("click", ()=>goCategory(c.id));
    card.innerHTML = `
      <div class="thumb">${c.title}</div>
      <div class="info">
        <div class="name">${escapeHtml(c.title)}</div>
        <div class="meta">المتبقي: ${total-usedN} / ${total}</div>
      </div>
    `;
    catsGrid.appendChild(card);
  }
}

function renderCategory(){
  const cat = getCategory(currentCategoryId);
  if(!cat){ goHome(); return; }

  catTitleChip.textContent = `التصنيف: ${cat.title}`;
  const usedN = countUsedInCategory(cat);
  catProgressChip.textContent = `المتبقي: ${cat.questions.length - usedN} / ${cat.questions.length}`;

  // sort: 200 ثم 400 ثم 600
  const qs = [...cat.questions].sort((a,b)=>(a.pts||0)-(b.pts||0));

  qGrid.innerHTML = "";
  for(const q of qs){
    const used = !!state.used[q.id];
    const btn = document.createElement("div");
    btn.className = "qbtn" + (used ? " used" : "");
    btn.innerHTML = `
      <div>
        <div class="label">${escapeHtml(shortLabel(q.q))}</div>
        <div class="sub">${escapeHtml(cat.title)}</div>
      </div>
      <div class="pts">${q.pts || 0}</div>
    `;
    btn.addEventListener("click", ()=>{
      if(used) return;
      openQuestion(cat, q);
    });
    qGrid.appendChild(btn);
  }
}

function renderAll(){
  renderScoreboard();
  renderHome();
  if(currentCategoryId) renderCategory();
}

/* =========================================
   Question modal
========================================= */
function openQuestion(cat, q){
  currentQuestion = { catId: cat.id, catTitle: cat.title, ...q };

  modalTag.textContent = cat.title;
  modalPts.textContent = `${q.pts||0} نقطة`;
  modalQ.textContent = q.q;

  // image
  if(q.img){
    imgWrap.style.display = "";
    modalImg.src = q.img;
  } else {
    imgWrap.style.display = "none";
    modalImg.src = "";
  }

  // answer hidden
  answerBox.style.display = "none";
  answerBox.textContent = q.a;

  // buttons
  pickTeamRow.style.display = "none";
  pickTeamRow.innerHTML = "";

  btnReveal.style.display = state.showAnswersFast ? "none" : "";
  btnWrong.style.display = state.showAnswersFast ? "" : "none";
  btnCorrect.style.display = state.showAnswersFast ? "" : "none";

  modalBack.style.display = "flex";

  if(state.showAnswersFast){
    revealAnswer();
  }
}

function revealAnswer(){
  answerBox.style.display = "";
  btnReveal.style.display = "none";
  btnWrong.style.display = "";
  btnCorrect.style.display = "";
}

function closeModal(){
  modalBack.style.display = "none";
  currentQuestion = null;
}

btnReveal.addEventListener("click", ()=>{
  revealAnswer();
});

btnWrong.addEventListener("click", ()=>{
  // mark used, no points
  if(!currentQuestion) return;
  markUsed(currentQuestion.id);
  showToast("تم تسجيلها: إجابة غلط (بدون نقاط)");
  closeModal();
  renderCategory();
});

btnCorrect.addEventListener("click", ()=>{
  if(!currentQuestion) return;
  // بعد ما يضغط صحيح: يطلع اختيار الفريق
  pickTeamRow.style.display = "";
  pickTeamRow.innerHTML = `<div class="muted" style="width:100%;padding:4px 2px 8px">اختر الفريق اللي جاوب:</div>`;

  for(const t of state.bank.teams){
    const b = document.createElement("button");
    b.textContent = `✅ ${t.name}`;
    b.addEventListener("click", ()=>{
      adjustTeamScore(t.id, +(currentQuestion.pts||0));
      markUsed(currentQuestion.id);
      showToast(`تمت إضافة ${(currentQuestion.pts||0)} لـ ${t.name}`);
      closeModal();
      renderCategory();
    });
    pickTeamRow.appendChild(b);
  }
});

el("btnClose").addEventListener("click", closeModal);
modalBack.addEventListener("click",(e)=>{
  if(e.target === modalBack) closeModal();
});

/* =========================================
   Score + Used
========================================= */
function adjustTeamScore(teamId, delta){
  const t = state.bank.teams.find(x=>x.id===teamId);
  if(!t) return;
  t.score = Math.max(0, (t.score||0) + delta);
  saveState();
  renderScoreboard();
}

function markUsed(qid){
  state.used[qid] = true;
  saveState();
}

/* =========================================
   Settings: import/export
========================================= */
el("btnImport").addEventListener("click", ()=>{
  const txt = el("bankText").value.trim();
  if(!txt) return showToast("الصق JSON أولاً");
  try{
    const obj = JSON.parse(txt);

    // validate minimal
    if(!obj.categories || !Array.isArray(obj.categories)) throw new Error("categories مفقود");
    for(const c of obj.categories){
      if(!c.id || !c.title || !Array.isArray(c.questions)) throw new Error("category ناقص");
      for(const q of c.questions){
        if(!q.id || !q.q || !q.a) throw new Error("سؤال ناقص");
        if(q.pts == null) q.pts = 200;
      }
    }
    if(!obj.teams || !Array.isArray(obj.teams) || obj.teams.length<2){
      obj.teams = deepClone(state.bank.teams); // حافظ على الفرق لو ما موجودة
    }

    state.bank = obj;

    // reset used because IDs might change
    state.used = {};
    saveState();
    showToast("تم استيراد البنك ✅");
    goHome();
  }catch(e){
    showToast("JSON غير صالح: " + e.message);
  }
});

el("btnExport").addEventListener("click", ()=>{
  el("bankText").value = JSON.stringify(state.bank, null, 2);
  showToast("تم تصدير البنك في المربع ✅");
});

el("btnResetScores").addEventListener("click", ()=>{
  for(const t of state.bank.teams) t.score = 0;
  saveState();
  showToast("تم تصفير النقاط ✅");
  renderScoreboard();
});

el("chkShowAnswersFast").addEventListener("change",(e)=>{
  state.showAnswersFast = !!e.target.checked;
  saveState();
});

/* =========================================
   Header buttons
========================================= */
el("btnHome").addEventListener("click", goHome);
el("btnSettings").addEventListener("click", goSettings);
el("btnBack").addEventListener("click", goHome);

el("btnReset").addEventListener("click", ()=>{
  if(!confirm("تبغى تصفّر الأسئلة المستخدمة؟")) return;
  state.used = {};
  saveState();
  showToast("تمت إعادة تعيين الأسئلة ✅");
  renderAll();
});

/* =========================================
   Helpers
========================================= */
function shortLabel(q){
  // يطلع سطر مختصر على زر السؤال
  const s = (q||"").trim();
  if(s.length <= 42) return s;
  return s.slice(0, 42) + "…";
}
function escapeHtml(str){
  return String(str||"")
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

/* =========================================
   Init
========================================= */
renderAll();
</script>
</body>
</html>
